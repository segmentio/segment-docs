#!/bin/bash

oauth_cookie="_oauth2_proxy_segment=ZW1haWw6eGF2aWVyQHNlZ21lbnQuY29tIHVzZXI6eGF2aWVyQHNlZ21lbnQuY29tfEZrM2VNc25TWkVVaWhSbHovTUhZTEc5ekJQU3RsZXZyaEFWYXhoSGFUSTBQM0FySmFmb3ltUysrSmNCemI5YjM2bG5ndW0rVFpoKzYrV3pjV2RmUWhTVFBlSTFIbWxvZk9UUHU5akUwVWhwQnlTYVN6U2cxUFA2Ly90Z0E4djZpU24zZW52S3Rxbm8vZHRaSksxQVVTWVpzSDdtVVZYNU5ObGJjRjdTU1hXRG5mMTcwS0ZhYlpiU091dXNmQ2w3cUhvKytKKzF0VjMxS2IyOXdUaGxTN2pQTlpzK1d2aXByUjh3S2FyaWFuNHdtREpjNkhPNVNCT04zeU45bFJQN0dHMjg5ZGtpUW5XQm9uTU5zejJzaENKWno1VU9PTTJxcy9vejcwbGhrbGpBUFdtV0MxeDlSY3BZREU5OTJyN09wdjVHWTZNSjUyc2pYWG1VYlFOVFdHaGtBZzZaQjRnY1lMOEVXWVZhYWcyaE9iWDd0TURCV3RDRWNob2gzbUp6bG9tL0VRWStyNTBsckJXZnlsWWpVRUgrLzBFVXhzS0JKanRXRm56TzVRVkROb3NmU1ZxTjZmZEhjTUtBQnhPaUpJWi9hR01odWN0dFhFa3JJaS9iODZ2SGY5Zis4UXF6N1d3TVZrOGVDTlpqVUp2cnFFZmpJZDJSL0ZCRG02UlFsMW1pVWVkUW1ZR3BXUzRyZW85WkRHVWZxZktYd1YyeXYvQS9EU25zamNiaGNHbC9XdGdEZnBWR2pIcWp3Z3VEajlIY25xc0FaZ3VtNFpoR282NXRoQUdEaCtGTHlRa1EySitPdUhyZTZOYVVRY0IwYjBPZ1lCTjNiNWdNZ2lEVlJDRzZlVzc0MjRsdHBhYUZmOU4rVVg5MThzOGxWeENEOWNrL2dZUnVNNzd2aXdhcHZPZ0xZN2E3U0VJSGlpZE1WQWRRS0JoaUNVQzJhYlJkOEdBYkZoSnVETmIyakU0UTlWdjBoS24vd1BjaXlhZWUwWkhDYmYwVmRJQmYxeDh5TWIza0d0NGpMcUJWTG1XTlgyZkJDblkyMElHYUlyZU5xV253bW5rclUweGxhU1RoeVJ5Yjh4S3BhK1B5L2szaERRZ2hIaVNMOEpJNVgwdE9zNFJZelg1eEdpTE93cDNDZDVyQmg3SUY0aE5KODFaSFdSMkRJVHFxaVMrSWRGNzBxVEdSQStsdWhEbEozUjFCVnFueUJjOTFFNUl5S1V0dHdkZ0FnVlJMNEJEYXIxazVMQkVnRUErOXMvRkZYZExBVW9JUlZjd204UzhtSkpBVDhKaU8yeEMzbUg5eGhKVHFjOHllN0dSZE01Y2w3em9FS3ZXNlZHT1NXc1hXQUdZVkpHMzF5MFRJT3FhSHV5anRWK0g0Uk01QjNvK2lPeFhaOWNpWXRncy9mMU45Q1pvUG9NRWFHS296c1E1TVZ6TU44c2FnV3l2dVdJRDF5clU3eWRCZU5xWHNHNnlMQ1FTbW1NSVlIdVJpd012S29LYmhvQXdJNWJpVmNhNmxpTG5PblllUElBOE9aS21TTmtkZTRvYzNURXJza2o3dnZySFc1MjlrZFpkUThEQnlEby9LOEF5ak1URDk0RkZBQm5sL3h8MTU3NTUwMzEwMXxuMjJoaTk1eTM3cGl0SVc3cjYvV1A2YWNlejVGYm9nOVJzd0FIdFVKNlArSkJyeEFJUEpzdDZqdEx4a20xRGVEVmR1VEdUOHhxWDNTQ2tjPQ==|1575499501|Rqcfx3DWzCzHxEvm7NwSo67gJVs="
while read p; do
  url="https://segment.build${p}"
  output=`curl -sS --cookie $oauth_cookie -H -v -o /dev/null -IL -w "%{http_code}" ${url}`
  if [ "$output" != "200" ]; then
    echo $p $output
  fi
done < tests/redirects/testPaths.txt

# curl --cookie "_oauth2_proxy_segment=ZW1haWw6eGF2aWVyQHNlZ21lbnQuY29tIHVzZXI6eGF2aWVyQHNlZ21lbnQuY29tfEZrM2VNc25TWkVVaWhSbHovTUhZTEc5ekJQU3RsZXZyaEFWYXhoSGFUSTBQM0FySmFmb3ltUysrSmNCemI5YjM2bG5ndW0rVFpoKzYrV3pjV2RmUWhTVFBlSTFIbWxvZk9UUHU5akUwVWhwQnlTYVN6U2cxUFA2Ly90Z0E4djZpU24zZW52S3Rxbm8vZHRaSksxQVVTWVpzSDdtVVZYNU5ObGJjRjdTU1hXRG5mMTcwS0ZhYlpiU091dXNmQ2w3cUhvKytKKzF0VjMxS2IyOXdUaGxTN2pQTlpzK1d2aXByUjh3S2FyaWFuNHdtREpjNkhPNVNCT04zeU45bFJQN0dHMjg5ZGtpUW5XQm9uTU5zejJzaENKWno1VU9PTTJxcy9vejcwbGhrbGpBUFdtV0MxeDlSY3BZREU5OTJyN09wdjVHWTZNSjUyc2pYWG1VYlFOVFdHaGtBZzZaQjRnY1lMOEVXWVZhYWcyaE9iWDd0TURCV3RDRWNob2gzbUp6bG9tL0VRWStyNTBsckJXZnlsWWpVRUgrLzBFVXhzS0JKanRXRm56TzVRVkROb3NmU1ZxTjZmZEhjTUtBQnhPaUpJWi9hR01odWN0dFhFa3JJaS9iODZ2SGY5Zis4UXF6N1d3TVZrOGVDTlpqVUp2cnFFZmpJZDJSL0ZCRG02UlFsMW1pVWVkUW1ZR3BXUzRyZW85WkRHVWZxZktYd1YyeXYvQS9EU25zamNiaGNHbC9XdGdEZnBWR2pIcWp3Z3VEajlIY25xc0FaZ3VtNFpoR282NXRoQUdEaCtGTHlRa1EySitPdUhyZTZOYVVRY0IwYjBPZ1lCTjNiNWdNZ2lEVlJDRzZlVzc0MjRsdHBhYUZmOU4rVVg5MThzOGxWeENEOWNrL2dZUnVNNzd2aXdhcHZPZ0xZN2E3U0VJSGlpZE1WQWRRS0JoaUNVQzJhYlJkOEdBYkZoSnVETmIyakU0UTlWdjBoS24vd1BjaXlhZWUwWkhDYmYwVmRJQmYxeDh5TWIza0d0NGpMcUJWTG1XTlgyZkJDblkyMElHYUlyZU5xV253bW5rclUweGxhU1RoeVJ5Yjh4S3BhK1B5L2szaERRZ2hIaVNMOEpJNVgwdE9zNFJZelg1eEdpTE93cDNDZDVyQmg3SUY0aE5KODFaSFdSMkRJVHFxaVMrSWRGNzBxVEdSQStsdWhEbEozUjFCVnFueUJjOTFFNUl5S1V0dHdkZ0FnVlJMNEJEYXIxazVMQkVnRUErOXMvRkZYZExBVW9JUlZjd204UzhtSkpBVDhKaU8yeEMzbUg5eGhKVHFjOHllN0dSZE01Y2w3em9FS3ZXNlZHT1NXc1hXQUdZVkpHMzF5MFRJT3FhSHV5anRWK0g0Uk01QjNvK2lPeFhaOWNpWXRncy9mMU45Q1pvUG9NRWFHS296c1E1TVZ6TU44c2FnV3l2dVdJRDF5clU3eWRCZU5xWHNHNnlMQ1FTbW1NSVlIdVJpd012S29LYmhvQXdJNWJpVmNhNmxpTG5PblllUElBOE9aS21TTmtkZTRvYzNURXJza2o3dnZySFc1MjlrZFpkUThEQnlEby9LOEF5ak1URDk0RkZBQm5sL3h8MTU3NTUwMzEwMXxuMjJoaTk1eTM3cGl0SVc3cjYvV1A2YWNlejVGYm9nOVJzd0FIdFVKNlArSkJyeEFJUEpzdDZqdEx4a20xRGVEVmR1VEdUOHhxWDNTQ2tjPQ==|1575499501|Rqcfx3DWzCzHxEvm7NwSo67gJVs=" -H -s -o /dev/null -IL -w "%{http_code}" segment.build/docs/spec/common
